<view class="container">
  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="login-prompt" wx:if="{{needLogin}}">
    <view class="prompt-content">
      <image class="prompt-logo" src="/assets/icons/home.png" mode="aspectFit" />
      <view class="prompt-title">æ¬¢è¿ä½¿ç”¨B2Bé”€å”®åŠ©æ‰‹</view>
      <view class="prompt-desc">è¯·å…ˆç™»å½•ä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½</view>
      <button class="login-button" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
    </view>
  </view>

  <!-- å·²ç™»å½•çŠ¶æ€ -->
  <view wx:else>
    <!-- ç”¨æˆ·ä¿¡æ¯å’Œé—®å€™ -->
    <view class="header-section">
      <view class="user-greeting">
        <view class="greeting-text">
          <view class="welcome">ä½ å¥½ï¼Œ{{userInfo.realName || 'ä¸šåŠ¡å‘˜'}}ï¼</view>
          <view class="date">{{currentDate}}</view>
        </view>
        <image class="user-avatar" src="{{userInfo.avatar || '/assets/icons/home.png'}}" mode="aspectFill" />
      </view>
    </view>

    <!-- ä»Šæ—¥æ•°æ®æ¦‚è§ˆ -->
    <view class="today-stats">
      <view class="stats-title">ä»Šæ—¥å·¥ä½œ</view>
      <view class="stats-grid">
        <view class="stat-item">
          <view class="stat-value">{{todayStats.completedVisits}}/{{todayStats.plannedVisits}}</view>
          <view class="stat-label">æ‹œè®¿è¿›åº¦</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{todayStats.newOrders}}</view>
          <view class="stat-label">æ–°å¢è®¢å•</view>
        </view>
        <view class="stat-item">
          <view class="stat-value">{{todayStats.todayRevenue}}</view>
          <view class="stat-label">ä»Šæ—¥ä¸šç»©</view>
        </view>
      </view>
    </view>

    <!-- å¿«æ·æ“ä½œ -->
    <view class="quick-actions">
      <view class="section-title">å¿«æ·æ“ä½œ</view>
      <view class="actions-grid">
        <view class="action-item" wx:for="{{quickActions}}" wx:key="id" bindtap="handleQuickAction" data-action="{{item.id}}">
          <view class="action-icon" style="background: {{item.color}};">
            <text class="icon-{{item.icon}}">ğŸ“±</text>
          </view>
          <view class="action-text">{{item.title}}</view>
        </view>
      </view>
    </view>

    <!-- ä¸šç»©æ¦‚è§ˆ -->
    <view class="performance-section">
      <view class="section-title">æœ¬æœˆä¸šç»©</view>
      <view class="performance-card">
        <view class="performance-main">
          <view class="current-amount">{{performance.currentMonth}}</view>
          <view class="target-info">ç›®æ ‡ï¼š{{performance.target}}</view>
        </view>
        <view class="performance-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{performance.completion}}%"></view>
          </view>
          <view class="progress-text">å®Œæˆåº¦ {{performance.completion}}%</view>
        </view>
        <view class="performance-ranking" wx:if="{{performance.ranking !== '-'}}">
          å›¢é˜Ÿæ’åï¼šç¬¬{{performance.ranking}}å
        </view>
      </view>
    </view>

    <!-- ä¸šåŠ¡æ•°æ® -->
    <view class="business-data">
      <view class="section-title">ä¸šåŠ¡æ¦‚å†µ</view>
      <view class="data-grid">
        <view class="data-item" bindtap="navigateToStores">
          <view class="data-value">{{businessData.totalStores}}</view>
          <view class="data-label">ç®¡ç†é—¨åº—</view>
          <view class="data-sub">æ´»è·ƒ {{businessData.activeStores}}</view>
        </view>
        <view class="data-item" bindtap="navigateToOrders">
          <view class="data-value">{{businessData.pendingOrders}}</view>
          <view class="data-label">å¾…å¤„ç†è®¢å•</view>
        </view>
        <view class="data-item">
          <view class="data-value">{{businessData.monthlyRevenue}}</view>
          <view class="data-label">æœ¬æœˆè¥æ”¶</view>
        </view>
      </view>
    </view>

    <!-- ä»Šæ—¥å®‰æ’ -->
    <view class="today-schedule" wx:if="{{todaySchedule.length > 0}}">
      <view class="section-title">ä»Šæ—¥å®‰æ’</view>
      <view class="schedule-list">
        <view class="schedule-item" wx:for="{{todaySchedule}}" wx:key="id">
          <view class="schedule-time">{{item.time}}</view>
          <view class="schedule-content">
            <view class="schedule-title">{{item.title}}</view>
            <view class="schedule-desc">{{item.description}}</view>
          </view>
          <view class="schedule-status {{item.status}}">{{item.statusText}}</view>
        </view>
      </view>
    </view>

    <!-- å¾…åŠäº‹é¡¹ -->
    <view class="todo-section" wx:if="{{todoList.length > 0}}">
      <view class="section-title">
        <text>å¾…åŠäº‹é¡¹</text>
        <view class="todo-count">{{todoList.length}}</view>
      </view>
      <view class="todo-list">
        <view class="todo-item" wx:for="{{todoList}}" wx:key="id" bindtap="handleTodoTap" data-todo="{{item}}">
          <view class="todo-icon {{item.priority}}">
            <text class="icon">{{item.icon || 'ğŸ“‹'}}</text>
          </view>
          <view class="todo-content">
            <view class="todo-title">{{item.title}}</view>
            <view class="todo-desc">{{item.description}}</view>
          </view>
          <view class="todo-time">{{item.timeAgo}}</view>
        </view>
      </view>
    </view>

    <!-- æ¶ˆæ¯é€šçŸ¥ -->
    <view class="notifications" wx:if="{{notifications.length > 0}}">
      <view class="section-title">æ¶ˆæ¯é€šçŸ¥</view>
      <view class="notification-list">
        <view class="notification-item" wx:for="{{notifications}}" wx:key="id">
          <view class="notification-icon {{item.type}}">{{item.icon}}</view>
          <view class="notification-content">
            <view class="notification-title">{{item.title}}</view>
            <view class="notification-time">{{item.timeAgo}}</view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>